id: full-featured-application
workloads:
  background-processor:
    kind: worker
    image:
      registry: myregistry.azurecr.io
      repository: myorg/background-processor
      tag: v2.5.0
    replicas: 6
    resources:
      requests:
        cpu: "1"
        memory: 1Gi
    autoscaling:
      vertical:
        enabled: true
      horizontal:
        enabled: true
        minReplicas: 6
        maxReplicas: 30
    labels:
      app: background-processor
      version: v2
      team: backend
      tier: backend
    annotations:
      apps.workleap.com/flavor: worker
      prometheus.io/scrape: "true"
  main-api:
    kind: api
    image:
      registry: myregistry.azurecr.io
      repository: myorg/main-api
      tag: v2.5.0
    replicas: 10
    ingress:
      pathPrefix: /api/v2
      fqdn: api.myapp.example.com
    resources:
      requests:
        cpu: 750m
        memory: 768Mi
    autoscaling:
      vertical:
        enabled: false
      horizontal:
        enabled: true
        minReplicas: 10
        maxReplicas: 50
    labels:
      app: main-api
      version: v2
      team: backend
      tier: frontend
      environment: production
      sla: high
      region: north-america
      datacenter: us-east-1
      traffic-zone: primary
    annotations:
      apps.workleap.com/flavor: api
      prometheus.io/scrape: "true"
      prometheus.io/port: "8080"
      prometheus.io/path: /metrics
