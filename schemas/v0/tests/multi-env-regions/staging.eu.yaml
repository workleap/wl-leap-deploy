id: full-featured-application
workloads:
  background-processor:
    kind: worker
    image:
      registry: myregistry.azurecr.io
      repository: myorg/background-processor
      tag: v2.5.0
    projectSource:
      path: /root/src/BackgroundProcessor/Dockerfile
    replicas: 2
    resources:
      requests:
        cpu: 500m
        memory: 512Mi
    autoscaling:
      vertical:
        enabled: true
      horizontal:
        enabled: true
        minReplicas: 2
        maxReplicas: 10
    labels:
      app: background-processor
      version: v2
      team: backend
      tier: backend
    annotations:
      apps.workleap.com/flavor: worker
      prometheus.io/scrape: "true"
  main-api:
    kind: api
    image:
      registry: myregistry.azurecr.io
      repository: myorg/main-api
      tag: v2.5.0
    projectSource:
      path: /root/src/MainApi/MainApi.csproj
    replicas: 2
    ingress:
      pathPrefix: /api/v2
      fqdn: api.myapp.example.com
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
    autoscaling:
      vertical:
        enabled: false
      horizontal:
        enabled: true
        minReplicas: 2
        maxReplicas: 4
    labels:
      app: main-api
      version: v2
      team: backend
      tier: frontend
      environment: staging
      region: europe
      datacenter: eu-west-1
      data-residency: eu
    annotations:
      apps.workleap.com/flavor: api
      prometheus.io/scrape: "true"
      prometheus.io/port: "8080"
      prometheus.io/path: /metrics
