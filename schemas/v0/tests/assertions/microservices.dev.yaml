id: ecommerce-platform
workloads:
  api-gateway:
    type: api
    image:
      repository: ecommerce/api-gateway
    ingress:
      pathPrefix: /
      fqdn: api.ecommerce.example.com
    replicas: 3
    resources:
      requests:
        cpu: 200m
        memory: 256Mi
    autoscaling:
      horizontal:
        minReplicas: 3
        maxReplicas: 15
    annotations:
      apps.workleap.com/flavor: gateway
  notification-worker:
    type: worker
    image:
      repository: ecommerce/notification-service
    replicas: 1
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
    annotations:
      apps.workleap.com/flavor: worker
  order-service:
    type: api
    image:
      repository: ecommerce/order-service
    ingress:
      pathPrefix: /orders
    replicas: 2
    resources:
      requests:
        cpu: 200m
        memory: 256Mi
  payment-worker:
    type: worker
    image:
      repository: ecommerce/payment-processor
    replicas: 2
    resources:
      requests:
        cpu: 300m
        memory: 384Mi
    annotations:
      apps.workleap.com/flavor: worker
      security.workleap.com/pci-dss: "true"
  product-catalog:
    type: api
    image:
      repository: ecommerce/product-catalog
    ingress:
      pathPrefix: /products
    replicas: 2
    resources:
      requests:
        cpu: 150m
        memory: 192Mi
  user-service:
    type: api
    image:
      repository: ecommerce/user-service
    ingress:
      pathPrefix: /users
    replicas: 2
    resources:
      requests:
        cpu: 100m
        memory: 128Mi
